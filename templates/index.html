<!DOCTYPE html>
<html>

<head>
  <title>Alt Text Check</title>
  <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='style.css') }}">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script>
    var suggestionsData = JSON.parse('{{ suggestions|safe }}');
    $(document).ready(function () {
    var suggestions = suggestionsData;
    var clickedWords = new Set();

    $("#textarea").on("click", ".misspelled", function () {
      var word = $(this).data("word");
      console.log(word);
      if (!clickedWords.has(word)) {
        clickedWords.add(word);
        var suggestion = suggestions[word];
        var elem = document.querySelector("#suggestionCard").cloneNode(true);
        elem.classList.remove("hidden");
        elem.querySelector("#error").textContent = "Fill in the name(s) for " + word;
        elem.querySelector("#suggestions").textContent = "Does '" + word + "' refer to any of these names: " + suggestion;
        elem.querySelector(".suggButton").addEventListener("click", function () {
          elem.remove();
          $(".misspelled[data-word='" + word + "']").removeClass("misspelled");
        });
        document.querySelector("#suggContainer").append(elem);
      }
    });
  });
  </script>
  <!-- <script type="text/javascript" src="{{ url_for('static', filename='script.js') }}"></script> -->
</head>

<body>
  <header>
    <h1>alt text check ✏️</h1>
  </header>
  <div class="imageContainer">
    <img src="{{ image_url }}" alt="Uploaded Image">
    <div class="contextContainer">
      <h2>{{ article_name | safe }}</h2>
      <p>{{ context | safe }}</p>
    </div>
  </div>
  <div class="widthContainer">
    <form id="textarea" action="{{ url_for('getText')}}" method="get">
      <div class="buttonContainer">
        <h2 contenteditable="true" name="editedText">{{ corrected_text | safe }}</h2>
        <button type="submit">submit edit</button>
      </div>
    </form>

    <div id="sidebar">
      <div id="suggContainer">
        <div id="suggestionCard" class="hidden">
          <h3 id="error"></h3>
          <p id="suggestions"></p>
          <button type="submit" class="suggButton">resolve</button>
        </div>
      </div>
    </div>
  </div>
</body>

</html>